{"ast":null,"code":"var _jsxFileName = \"/Users/manoelnetom/Downloads/exemplosReact/ExemplosReact/chamados/src/contexts/auth.js\",\n    _s = $RefreshSig$();\n\nimport { useState, createContext, useEffect } from 'react';\nimport firebase from '../services/firebaseConnection';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\n\nfunction AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null); //const [loadingAuth, setLoadingAuth] = useState(false);\n\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    function loadUser() {\n      const storagedUser = localStorage.getItem(\"usuarioLogado\");\n\n      if (storagedUser) {\n        setUser(JSON.parse(storagedUser)); //setLoading(true);\n      } //setLoading(false);\n\n    }\n\n    loadUser();\n  }, []);\n\n  async function signUp(email, password, nome) {\n    setLoading(true);\n    await firebase.auth().createUserWithEmailAndPassword(email, password).then(async value => {\n      let data = {\n        uid: value.user.uid,\n        nome: nome,\n        email: email,\n        avatarUrl: null\n      };\n      await firebase.firestore().collection('users').doc(data.uid).set({\n        nome: nome,\n        avatarUrl: null\n      }).then(() => {\n        setUser(data);\n        localStorage.setItem('usuarioLogado', JSON.stringify(data));\n        setLoading(false);\n        toast.success('Usuário Cadastrado');\n      }).catch(error => {\n        console.log(error);\n        setLoading(false);\n        toast.error('Ops....ocorreu algum erro');\n      });\n    }).catch(error => {\n      console.log(error);\n      setLoading(false);\n      toast.error('Ops....ocorreu algum erro');\n    });\n  }\n\n  async function signIn(email, password) {\n    setLoading(true);\n    await firebase.auth().signInWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      let usuario = await firebase.firestore().collection('users').doc(uid).get();\n      let data = {\n        uid: uid,\n        nome: usuario.data().nome,\n        email: email,\n        avatarUrl: usuario.data().avatarUrl\n      }; //console.log(usuario.data());\n\n      setUser(data);\n      setLocalUser(data);\n      setLoading(false);\n      toast.success('Bem-vindo de volta!!');\n    }).catch(error => {\n      console.log(error);\n      setLoading(false);\n      toast.success('Ops ocorreu algum erro!');\n    });\n  }\n\n  async function signOut() {\n    await firebase.auth().signOut();\n    localStorage.removeItem('usuarioLogado');\n    setUser(null);\n  }\n\n  function setLocalUser(data) {\n    localStorage.setItem('usuarioLogado', JSON.stringify(data));\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      signUp,\n      signOut,\n      signIn,\n      loading,\n      setUser,\n      setLocalUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AuthProvider, \"Vot/f62t7wRmBOt67JIN3/+eVxk=\");\n\n_c = AuthProvider;\nexport default AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","createContext","useEffect","firebase","toast","AuthContext","AuthProvider","children","user","setUser","loading","setLoading","loadUser","storagedUser","localStorage","getItem","JSON","parse","signUp","email","password","nome","auth","createUserWithEmailAndPassword","then","value","data","uid","avatarUrl","firestore","collection","doc","set","setItem","stringify","success","catch","error","console","log","signIn","signInWithEmailAndPassword","usuario","get","setLocalUser","signOut","removeItem","signed"],"sources":["/Users/manoelnetom/Downloads/exemplosReact/ExemplosReact/chamados/src/contexts/auth.js"],"sourcesContent":["import { useState, createContext, useEffect } from 'react'\nimport firebase from '../services/firebaseConnection'\nimport { toast } from 'react-toastify';\nexport const AuthContext = createContext({});\n\nfunction AuthProvider({ children }) {\n    const [user, setUser] = useState(null);\n    //const [loadingAuth, setLoadingAuth] = useState(false);\n    const [loading, setLoading] = useState(false);\n\n    useEffect(() => {\n        function loadUser() {\n            const storagedUser = localStorage.getItem(\"usuarioLogado\");\n            if (storagedUser) {\n                setUser(JSON.parse(storagedUser));\n                //setLoading(true);\n            }\n            //setLoading(false);\n        }\n        loadUser();\n    }, []);\n\n    async function signUp(email, password, nome) {\n        setLoading(true);\n        await firebase.auth().createUserWithEmailAndPassword(email, password)\n            .then(async (value) => {\n                let data = {\n                    uid: value.user.uid,\n                    nome: nome,\n                    email: email,\n                    avatarUrl: null\n                };\n                await firebase.firestore().collection('users')\n                    .doc(data.uid)\n                    .set({\n                        nome: nome,\n                        avatarUrl: null\n                    })\n                    .then(() => {\n                        setUser(data);\n                        localStorage.setItem('usuarioLogado', JSON.stringify(data));\n                        setLoading(false);\n                        toast.success('Usuário Cadastrado');\n                    })\n                    .catch((error) => {\n                        console.log(error);\n                        setLoading(false);\n                        toast.error('Ops....ocorreu algum erro');\n                    })\n            })\n            .catch((error) => {\n                console.log(error);\n                setLoading(false);\n                toast.error('Ops....ocorreu algum erro');\n            })\n    }\n\n    async function signIn(email, password) {\n        setLoading(true);\n        await firebase.auth().signInWithEmailAndPassword(email, password)\n            .then(async (value) => {\n                let uid = value.user.uid;\n\n                let usuario = await firebase.firestore().collection('users')\n                    .doc(uid)\n                    .get();\n                let data = {\n                    uid: uid,\n                    nome: usuario.data().nome,\n                    email: email,\n                    avatarUrl: usuario.data().avatarUrl\n                }\n                //console.log(usuario.data());\n                setUser(data);\n                setLocalUser(data);\n                setLoading(false);\n                toast.success('Bem-vindo de volta!!');\n            })\n            .catch((error) => {\n                console.log(error);\n                setLoading(false);\n                toast.success('Ops ocorreu algum erro!');\n            })\n    }\n\n\n    async function signOut() {\n        await firebase.auth().signOut();\n        localStorage.removeItem('usuarioLogado');\n        setUser(null);\n    }\n\n    function setLocalUser(data){\n        localStorage.setItem('usuarioLogado', JSON.stringify(data));\n    }\n\n    return (\n        <AuthContext.Provider value={{\n            signed: !!user,\n            user,\n            signUp,\n            signOut,\n            signIn,\n            loading,\n            setUser,\n            setLocalUser\n        }}>\n            {children}\n        </AuthContext.Provider>\n    );\n}\nexport default AuthProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}